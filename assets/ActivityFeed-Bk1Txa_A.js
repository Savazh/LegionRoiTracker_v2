import{j as e,A as y,m as g}from"./index-0mpu58Uf.js";import{r as n}from"./vendor-DLkZsigC.js";import{s as o}from"./supabase-DfW3Se1t.js";import{h as v}from"./charts-R36fmogF.js";import{A as d}from"./award-C8T31VSm.js";import{a as j,T as N,M as b}from"./trending-up-sbRTy8tY.js";function z({tokenId:r}){const[l,m]=n.useState([]),[p,x]=n.useState(!0);n.useEffect(()=>{const t=async()=>{try{const{data:i}=await o.from("comments").select("*").eq("token_id",r).order("created_at",{ascending:!1}).limit(10),{data:c}=await o.from("price_predictions").select("*").eq("token_id",r).order("created_at",{ascending:!1}).limit(10),h=[...(i==null?void 0:i.map(a=>({id:`comment-${a.id}`,type:"comment",content:a.content,timestamp:a.created_at,user:a.nickname})))||[],...(c==null?void 0:c.map(a=>({id:`prediction-${a.id}`,type:"prediction",content:`Predicted $${a.predicted_price.toFixed(6)} by ${new Date(a.target_date).toLocaleDateString()}`,timestamp:a.created_at,user:a.nickname,metadata:{predictionAccuracy:Math.random()>.5?Math.floor(Math.random()*100):void 0}})))||[]].sort((a,f)=>new Date(f.timestamp).getTime()-new Date(a.timestamp).getTime());m(h)}catch(i){console.error("Error fetching activities:",i)}finally{x(!1)}};t();const s=setInterval(t,3e4);return()=>clearInterval(s)},[r]);const u=t=>{switch(t){case"comment":return e.jsx(b,{className:"text-cyan-400",size:16});case"prediction":return e.jsx(N,{className:"text-pink-400",size:16});case"vote":return e.jsx(j,{className:"text-green-400",size:16});case"achievement":return e.jsx(d,{className:"text-yellow-400",size:16})}};return p?e.jsxs("div",{className:"bg-black/20 p-6 rounded-lg border border-cyan-500/10",children:[e.jsx("h2",{className:"text-xl font-semibold text-pink-500 mb-4",children:"Live Activity"}),e.jsx("div",{className:"animate-pulse space-y-4",children:[...Array(5)].map((t,s)=>e.jsx("div",{className:"h-16 bg-black/40 rounded-lg"},s))})]}):e.jsxs("div",{className:"bg-black/20 p-6 rounded-lg border border-cyan-500/10",children:[e.jsx("h2",{className:"text-xl font-semibold text-pink-500 mb-4",children:"Live Activity"}),e.jsx("div",{className:"space-y-4",children:e.jsx(y,{children:l.map(t=>{var s;return e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},className:"p-4 bg-black/40 rounded-lg border border-cyan-500/20 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-pink-500/5 to-cyan-500/5 opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-1",children:u(t.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-cyan-300 font-medium",children:t.user}),e.jsx("span",{className:"text-cyan-500/60 text-sm",children:v(new Date(t.timestamp),{addSuffix:!0})})]}),e.jsx("p",{className:"text-cyan-100 mt-1",children:t.content}),((s=t.metadata)==null?void 0:s.predictionAccuracy)!==void 0&&e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(d,{className:"text-yellow-400",size:16}),e.jsxs("span",{className:"text-yellow-400 text-sm",children:["Prediction Accuracy: ",t.metadata.predictionAccuracy,"%"]})]})]})]})})]},t.id)})})})]})}export{z as ActivityFeed};
